pipeline:
  build:
    image: ubuntu:16.04
    commands:
      - apt-get update
      - pwd
      - echo "start"

  publish:
    image: plugins/docker
    registry: https://index.docker.io/v1/
    dockerfile: ./Dockerfile
    repo: xuguoliang1995/drone 
    secrets: [ xuguoliang1995, "0123qw456xuguo" ]
    tags:
      - latest

  deploy:
      image: xuguoliang/drone
      host: 120.78.93.5
      username: root
      password: 0123qw456xuguo?    
      port: 22
      #secrets: [ ssh_password ]
      script:
        - pwd
        - docker push xuguoliang1995/drone 
        - docker start xuguoliang1995/drone

  notify:
    image: xuguoliang1995/drone
    host: 122
    username: foo
    password: bar
    from: drone@your-domain.com
#+   attachment: build-result.xml
#    when:
#      status: [ changed, failure ]

